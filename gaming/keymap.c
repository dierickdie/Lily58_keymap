//#include "lily58.h"
#include "sofle.h"
//#include QMK_KEYBOARD_H

// Layers
#define _GAME       0
#define _FN         1

// Macro keycodes
  enum custom_keycodes {
  MAKE = SAFE_RANGE,
};

// Readability keycodes
#define _______		  KC_TRNS
#define xxxxxxx     KC_TRNS

// Layer codes
#define FN 		  	  MO(_FN)

#define FN_ESC		  LT(_FN, KC_ESC)
#define FN_TAB		  LT(_FN, KC_TAB)
#define FN_BSPC     LT(_FN, KC_BSPC)
#define FN_ENT		  LT(_FN, KC_ENT)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

/* GAME
 * .-----------------------------------------------------------------------.                              .-----------------------------------------------------------------------.
 * |    Esc    |     1     |     2     |     3     |     4     |     5     |                              |     6     |     7     |     8     |     9     |     0     |   Bspc    |
 * |-----------+-----------+-----------+-----------+-----------+-----------|                              |-----------------------------------------------------------------------|
 * |    Tab    |     Q     |     W     |     E     |     R     |     T     |                              |     Y     |     U     |     I     |     O     |     P     |    Del    |
 * |-----------+-----------+-----------+-----------+-----------+-----------|                              |-----------------------------------------------------------------------|
 * |   Ctrl    |     A     |     S     |     D     |     F     |     G     |-----------.      .-----------|     H     |     J     |     K     |     L     |     ;     |    '      |
 * |-----------+-----------+-----------+-----------+-----------+-----------|  Volume   |      |           |-----------------------------------------------------------------------|
 * |   Shift   |     Z     |     X     |     C     |     V     |     B     |-----------'      '-----------|     N     |     M     |     ,     |     .     |     /     |   Enter   |
 * '-----------------------------------------------------------------------'-----------.      .-----------'-----------------------------------------------------------------------'
 *                               |    Fn     |   Alt     |  Space   |     /   Enter   /        \   Space   \      |   Space   |    Alt    |   Ctrl    |
 *                               '----------------------------------'    '-----------'          '-----------'     '-----------------------------------'
 */

 [_GAME] = LAYOUT( \
    KC_ESC,     KC_1,       KC_2,       KC_3,       KC_4,       KC_5,                                    KC_6,       KC_7,       KC_8,       KC_9,       KC_0,       KC_BSPC,   \
    KC_TAB,     KC_Q,       KC_W,       KC_E,       KC_R,       KC_T,                                    KC_Y,       KC_U,       KC_I,       KC_O,       KC_P,       KC_DEL,    \
    KC_LCTRL,   KC_A,       KC_S,       KC_D,       KC_F,       KC_G,                                    KC_H,       KC_J,       KC_K,       KC_L,       KC_SCLN,    KC_QUOT,   \
    KC_LSFT,    KC_Z,       KC_X,       KC_C,       KC_V,       KC_B,    KC_MUTE,             KC_MPLY,   KC_N,       KC_M,       KC_COMM,    KC_DOT,     KC_SLSH,    KC_ENT,    \
                      xxxxxxx,     FN,       KC_LALT,   KC_SPC,      KC_ENT,                      KC_SPC,         KC_SPC,       KC_RALT,    KC_RCTRL,    xxxxxxx                \
), 

/* FN
 * .-----------------------------------------------------------------------.                              .-----------------------------------------------------------------------.
 * |           |    F1     |    F2     |    F3     |    F4     |    F5     |                              |    F6     |    F7     |    F8     |     F9    |    F10    |           |
 * |-----------+-----------+-----------+-----------+-----------+-----------|                              |-----------+-----------+-----------+-----------+-----------+-----------|
 * |           |           |   MAKE    |           |   Reset   |           |                              |           |           |           |           |           |           |
 * |-----------+-----------+-----------+-----------+-----------+-----------|                              |-----------+-----------+-----------+-----------+-----------+-----------|
 * |           |   Left    |   Down    |    Up     |   Right   |           |-----------.      .-----------|           |   Left    |   Down    |    Up     |   Right   |           |
 * |-----------+-----------+-----------+-----------+-----------+-----------|           |      |           |-----------+-----------+-----------+-----------+-----------+-----------|
 * |           |           |           |           |           |           |-----------'      '-----------|           |           |           |           |           |           |
 * '-----------------------------------------------------------------------'-----------.       .----------'-----------------------------------------------------------------------'
 *                               |    Fn     |           |          |     /           /         \           \    |           |    F11    |    F12    |
 *                               '----------------------------------'    '-----------'           '-----------'   '-----------------------------------'
 */

 [_FN] = LAYOUT( \
    _______,    KC_F1,      KC_F2,      KC_F3,      KC_F4,      KC_F5,                                    KC_F6,      KC_F7,      KC_F8,      KC_F9,      KC_F10,     _______,   \
    _______,    _______,    MAKE,       _______,    RESET,      _______,                                  _______,    _______,    _______,    _______,    _______,    _______,   \
    _______,    KC_LEFT,    KC_DOWN,    KC_UP,      KC_RIGHT,   _______,                                  _______,    KC_LEFT,    KC_DOWN,    KC_UP,      KC_RIGHT,   _______,   \
    _______,    _______,    _______,    _______,    _______,    _______,    _______,          _______,    _______,    _______,    _______,    _______,    _______,    _______,   \
                      xxxxxxx,    _______,    _______,    _______,        _______,              _______,           _______,    KC_F11,     KC_F12,     xxxxxxx                   \
),

};

// Macros
bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  switch (keycode) {
    case MAKE:
      if (record->event.pressed) {
        // when keycode is pressed
        SEND_STRING("make sofle:gaming:dfu");
      } else {
        // when keycode is released
      }
      break;
  }
  return true;
};

// Encoder
#ifdef ENCODER_ENABLE
void encoder_update_user(uint8_t index, bool clockwise) {
  // left encoder
  if (index == 0) {
    switch(biton32(layer_state)){
      case 0: // Game layer
      if (clockwise) { // Volume control
        tap_code(KC_VOLD);
      } else {
        tap_code(KC_VOLU);
      }
      break;

    }
  }
}
#endif

/* 
 * .-----------------------------------------------------------------------.
 * |           |           |           |           |           |           |
 * |-----------+-----------+-----------+-----------+-----------+-----------|
 * |           |           |           |           |           |           |
 * |-----------+-----------+-----------+-----------+-----------+-----------|
 * |           |           |           |           |           |           |-----------.
 * |-----------+-----------+-----------+-----------+-----------+-----------|           |
 * |           |           |           |           |           |           |-----------'
 * '-----------------------------------------------------------------------'-----------.
 *                               |           |           |          |     /           /
 *                               '----------------------------------'    '-----------'
 */

 /*[_LAYER] = LAYOUT( \
    _______,    _______,    _______,    _______,    _______,    _______,                                  _______,    _______,    _______,    _______,    _______,    _______,   \
    _______,    _______,    _______,    _______,    _______,    _______,                                  _______,    _______,    _______,    _______,    _______,    _______,   \
    _______,    _______,    _______,    _______,    _______,    _______,                                  _______,    _______,    _______,    _______,    _______,    _______,   \
    _______,    _______,    _______,    _______,    _______,    _______,    _______,          _______,    _______,    _______,    _______,    _______,    _______,    _______,   \
                      _______,    _______,    _______,    _______,        _______,             _______,           _______,    _______,    _______,    _______                   \
),
*/